const fs = require('fs')
const path = require('path')
const Template = require("../template");

const stub = `
# This file was autogenerated at {{generatedAt}}.
{{pathsToIgnore}}
`;

module.exports = function (params, writeFile = true) {
  const {
    pathsToIgnore = [],
    generatedAt = new Date().toISOString(),
  } = params;

  const template = new Template({ stub });

  const content = template.render({
    generatedAt,
    pathsToIgnore: [
      '.github',
      '.vscode',
      'manifests',
    ].concat(pathsToIgnore).join('\n'),
  })

  if (writeFile) {
    fs.writeFileSync(path.join(process.cwd(), '.dockerignore'), content)
  }
  
  return content
}
